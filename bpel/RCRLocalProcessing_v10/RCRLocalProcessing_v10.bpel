<!-- RCRLocalProcessing_v10 BPEL Process [Generated by the Oracle BPEL Designer]  -->
<process name="RCRLocalProcessing_v10" targetNamespace="http://emayor.org/RCRLocalProcessing_v10" suppressJoinFailure="yes" xmlns="http://schemas.xmlsoap.org/ws/2003/03/business-process/" xmlns:bpws="http://schemas.xmlsoap.org/ws/2003/03/business-process/" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:tns="http://emayor.org/RCRLocalProcessing_v10" xmlns:ns1="http://www.emayor.org/eMayorServiceRequest.xsd" xmlns:bpelx="http://schemas.oracle.com/bpel/extension" xmlns:ora="http://schemas.oracle.com/xpath/extension" xmlns:nsxml0="http://emayor.org/MunicipalityAdaptationLayer_v10"><!-- ================================================================= --><!-- PARTNERLINKS                                                      --><!-- List of services participating in this BPEL process               --><!-- ================================================================= -->
 <partnerLinks><!--
        The 'client' role represents the requester of this service. It is 
        used for callback. The location and correlation information associated
        with the client role are automatically set using WS-Addressing.
        -->
  <partnerLink name="client" partnerLinkType="tns:RCRLocalProcessing_v10" myRole="RCRLocalProcessing_v10Provider" partnerRole="RCRLocalProcessing_v10Requester"/>
  <partnerLink name="municipalityPL" partnerLinkType="nsxml0:MunicipalityAdaptationLayer_v10" partnerRole="MunicipalityAdaptationLayer_v10Provider"/>
 </partnerLinks><!-- ================================================================= --><!-- VARIABLES                                                         --><!-- List of messages and XML documents used within this BPEL process  --><!-- ================================================================= -->
 <variables><!-- Reference to the message passed as input during initiation -->
  <variable name="input" messageType="tns:RCRLocalProcessing_v10RequestMessage"/><!-- Reference to the message that will be sent back to the 
             requester during callback
             -->
  <variable name="output" messageType="tns:RCRLocalProcessing_v10ResponseMessage"/>
  <variable name="requestData" messageType="nsxml0:MunicipalityAdaptationLayer_v10RequestMessage"/>
 </variables><!-- ================================================================= --><!-- ORCHESTRATION LOGIC                                               --><!-- Set of activities coordinating the flow of messages across the    --><!-- services integrated within this business process                  --><!-- ================================================================= -->
 <sequence name="main"><!-- Receive input from requestor. 
             Note: This maps to operation defined in RCRLocalProcessing_v10.wsdl 
             -->
  <receive name="receiveInput" partnerLink="client" portType="tns:RCRLocalProcessing_v10" operation="initiate" variable="input" createInstance="yes"/><!-- Asynchronous callback to the requester.
             Note: the callback location and correlation id is transparently handled 
             using WS-addressing.
             -->
  <assign name="globalPreparation">
   <copy>
    <from variable="input" part="payload" query="/tns:RCRLocalProcessing_v10Request"/>
    <to variable="requestData" part="payload" query="/nsxml0:MunicipalityAdaptationLayer_v10Request"/>
   </copy>
  </assign>
  <scope name="processing">
   <variables>
    <variable name="munIn" messageType="nsxml0:MunicipalityAdaptationLayer_v10RequestMessage"/>
    <variable name="munOut" messageType="nsxml0:MunicipalityAdaptationLayer_v10ResponseMessage"/>
   </variables>
   <sequence>
    <assign name="prepareInput">
     <copy>
      <from variable="requestData" part="payload" query="/nsxml0:MunicipalityAdaptationLayer_v10Request"/>
      <to variable="munIn" part="payload" query="/nsxml0:MunicipalityAdaptationLayer_v10Request"/>
     </copy>
    </assign>
    <invoke name="invoke-1" partnerLink="municipalityPL" portType="nsxml0:MunicipalityAdaptationLayer_v10" operation="process" inputVariable="munIn" outputVariable="munOut"/>
    <assign name="prepareOutput">
     <copy>
      <from variable="munOut" part="payload" query="/nsxml0:MunicipalityAdaptationLayer_v10Response"/>
      <to variable="requestData" part="payload" query="/nsxml0:MunicipalityAdaptationLayer_v10Request"/>
     </copy>
    </assign>
   </sequence>
  </scope>
  <assign name="globalOutputProcessing">
   <copy>
    <from variable="requestData" part="payload" query="/nsxml0:MunicipalityAdaptationLayer_v10Request"/>
    <to variable="output" part="payload" query="/tns:RCRLocalProcessing_v10Response"/>
   </copy>
  </assign>
  <invoke name="callbackClient" partnerLink="client" portType="tns:RCRLocalProcessing_v10Callback" operation="onResult" inputVariable="output"/>
 </sequence>
</process>
