<!-- ForwardRequest_v10 BPEL Process [Generated by the Oracle BPEL Designer]  -->
<process name="ForwardRequest_v10" targetNamespace="http://emayor.org/ForwardRequest_v10" suppressJoinFailure="yes" xmlns="http://schemas.xmlsoap.org/ws/2003/03/business-process/" xmlns:bpws="http://schemas.xmlsoap.org/ws/2003/03/business-process/" xmlns:tns="http://emayor.org/ForwardRequest_v10" xmlns:nsxml1="http://eMayor.org/sh/bpel/forward/service" xmlns:xsd="http://www.w3.org/2001/XMLSchema" xmlns:nsxml2="http://eMayor.org/sh/bpel/forward/data" xmlns:bpelx="http://schemas.oracle.com/bpel/extension" xmlns:ora="http://schemas.oracle.com/xpath/extension" xmlns:nsxml0="http://www.emayor.org/eMayorServiceRequest.xsd"><!-- ================================================================= --><!-- PARTNERLINKS                                                      --><!-- List of services participating in this BPEL process               --><!-- ================================================================= -->
 <partnerLinks><!--
        The 'client' role represents the requester of this service. It is 
        used for callback. The location and correlation information associated
        with the client role are automatically set using WS-Addressing.
        -->
  <partnerLink name="client" partnerLinkType="tns:ForwardRequest_v10" myRole="ForwardRequest_v10Provider" partnerRole="ForwardRequest_v10Requester"/>
  <partnerLink name="forwardPL" partnerLinkType="nsxml1:IForwardManagerBPELService" partnerRole="IForwardManagerBPELServiceProvider" myRole="IForwardManagerBPELServiceRequester"/>
 </partnerLinks><!-- ================================================================= --><!-- VARIABLES                                                         --><!-- List of messages and XML documents used within this BPEL process  --><!-- ================================================================= -->
 <variables><!-- Reference to the message passed as input during initiation -->
  <variable name="input" messageType="tns:ForwardRequest_v10RequestMessage"/><!-- Reference to the message that will be sent back to the 
             requester during callback
             -->
  <variable name="output" messageType="tns:ForwardRequest_v10ResponseMessage"/>
 </variables><!-- ================================================================= --><!-- ORCHESTRATION LOGIC                                               --><!-- Set of activities coordinating the flow of messages across the    --><!-- services integrated within this business process                  --><!-- ================================================================= -->
 <sequence name="main"><!-- Receive input from requestor. 
             Note: This maps to operation defined in ForwardRequest_v10.wsdl 
             -->
  <receive name="receiveInput" partnerLink="client" portType="tns:ForwardRequest_v10" operation="initiate" variable="input" createInstance="yes"/><!-- Asynchronous callback to the requester.
             Note: the callback location and correlation id is transparently handled 
             using WS-addressing.
             -->
  <scope name="processing">
   <variables>
    <variable name="forwardIn" messageType="nsxml1:forwardRequestRequestMessage"/>
    <variable name="forwardOut" messageType="nsxml1:onResultRequestMessage"/>
   </variables>
   <sequence>
    <assign name="prepareInput">
     <copy>
      <from variable="input" part="payload" query="/tns:ForwardRequest_v10Request/nsxml0:uid"/>
      <to variable="forwardIn" part="payload" query="/nsxml1:fRequest/nsxml2:uid"/>
     </copy>
     <copy>
      <from variable="input" part="payload" query="/tns:ForwardRequest_v10Request/nsxml0:ssid"/>
      <to variable="forwardIn" part="payload" query="/nsxml1:fRequest/nsxml2:ssid"/>
     </copy>
     <copy>
      <from variable="input" part="payload" query="/tns:ForwardRequest_v10Request/nsxml0:reqestDocument"/>
      <to variable="forwardIn" part="payload" query="/nsxml1:fRequest/nsxml2:document"/>
     </copy>
     <copy>
      <from variable="input" part="payload" query="/tns:ForwardRequest_v10Request/nsxml0:serviceId"/>
      <to variable="forwardIn" part="payload" query="/nsxml1:fRequest/nsxml2:serviceId"/>
     </copy>
     <copy>
      <from variable="input" part="payload" query="/tns:ForwardRequest_v10Request/nsxml0:extraField4"/>
      <to variable="forwardIn" part="payload" query="/nsxml1:fRequest/nsxml2:remoteMunicipalityId"/>
     </copy>
     <copy>
      <from variable="input" part="payload" query="/tns:ForwardRequest_v10Request/nsxml0:extraField1"/>
      <to variable="forwardIn" part="payload" query="/nsxml1:fRequest/nsxml2:document1"/>
     </copy>
     <copy>
      <from variable="input" part="payload" query="/tns:ForwardRequest_v10Request/nsxml0:extraField2"/>
      <to variable="forwardIn" part="payload" query="/nsxml1:fRequest/nsxml2:document2"/>
     </copy>
     <copy>
      <from variable="input" part="payload" query="/tns:ForwardRequest_v10Request/nsxml0:extraField3"/>
      <to variable="forwardIn" part="payload" query="/nsxml1:fRequest/nsxml2:document3"/>
     </copy>
    </assign>
    <invoke name="invokeForward" partnerLink="forwardPL" portType="nsxml1:IForwardManagerBPEL" operation="forwardRequest" inputVariable="forwardIn"/>
    <receive createInstance="no" name="receiveForward" partnerLink="forwardPL" portType="nsxml1:IForwardManagerBPELCallback" operation="onResult" variable="forwardOut"/>
    <assign name="prepareOutput">
     <copy>
      <from variable="input" part="payload" query="/tns:ForwardRequest_v10Request/nsxml0:forwarded"/>
      <to variable="output" part="payload" query="/tns:ForwardRequest_v10Response/nsxml0:forwarded"/>
     </copy>
     <copy>
      <from variable="input" part="payload" query="/tns:ForwardRequest_v10Request/nsxml0:status"/>
      <to variable="output" part="payload" query="/tns:ForwardRequest_v10Response/nsxml0:status"/>
     </copy>
     <copy>
      <from variable="input" part="payload" query="/tns:ForwardRequest_v10Request/nsxml0:ssid"/>
      <to variable="output" part="payload" query="/tns:ForwardRequest_v10Response/nsxml0:ssid"/>
     </copy>
     <copy>
      <from variable="input" part="payload" query="/tns:ForwardRequest_v10Request/nsxml0:uid"/>
      <to variable="output" part="payload" query="/tns:ForwardRequest_v10Response/nsxml0:uid"/>
     </copy>
     <copy>
      <from variable="forwardOut" part="payload" query="/nsxml1:fOnResult/nsxml2:document"/>
      <to variable="output" part="payload" query="/tns:ForwardRequest_v10Response/nsxml0:reqestDocument"/>
     </copy>
     <copy>
      <from variable="input" part="payload" query="/tns:ForwardRequest_v10Request/nsxml0:reqDocDigSig"/>
      <to variable="output" part="payload" query="/tns:ForwardRequest_v10Response/nsxml0:reqDocDigSig"/>
     </copy>
     <copy>
      <from variable="input" part="payload" query="/tns:ForwardRequest_v10Request/nsxml0:serviceId"/>
      <to variable="forwardOut" part="payload" query="/nsxml1:fOnResult/nsxml2:serviceId"/>
     </copy>
     <copy>
      <from variable="input" part="payload" query="/tns:ForwardRequest_v10Request/nsxml0:extraField4"/>
      <to variable="forwardOut" part="payload" query="/nsxml1:fOnResult/nsxml2:remoteMunicipalityId"/>
     </copy>
     <copy>
      <from variable="forwardOut" part="payload" query="/nsxml1:fOnResult/nsxml2:document2"/>
      <to variable="output" part="payload" query="/tns:ForwardRequest_v10Response/nsxml0:extraField2"/>
     </copy>
     <copy>
      <from variable="forwardOut" part="payload" query="/nsxml1:fOnResult/nsxml2:document1"/>
      <to variable="output" part="payload" query="/tns:ForwardRequest_v10Response/nsxml0:extraField1"/>
     </copy>
     <copy>
      <from variable="forwardOut" part="payload" query="/nsxml1:fOnResult/nsxml2:document3"/>
      <to variable="output" part="payload" query="/tns:ForwardRequest_v10Response/nsxml0:extraField3"/>
     </copy>
    </assign>
   </sequence>
  </scope>
  <invoke name="callbackClient" partnerLink="client" portType="tns:ForwardRequest_v10Callback" operation="onResult" inputVariable="output"/>
 </sequence>
</process>
